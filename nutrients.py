import streamlit as st
import pandas as pd

# áƒ¡áƒáƒ™áƒ•áƒ”áƒ‘áƒ˜ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜
products_data = {
    'áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ˜': [
        'áƒ¦áƒ•áƒ˜áƒœáƒ˜áƒ¡ áƒ¦áƒ˜áƒ áƒ®áƒáƒ áƒªáƒ˜', 'áƒ¦áƒáƒ áƒ˜áƒ¡ áƒ¦áƒ•áƒ˜áƒ«áƒšáƒ˜', 'áƒ›áƒ¡áƒ®áƒ•áƒ˜áƒšáƒ¤áƒ”áƒ®áƒ áƒ áƒ¥áƒáƒ¡áƒáƒœáƒ˜', 'áƒ¥áƒáƒ—áƒ›áƒ˜áƒ¡ áƒ¦áƒ•áƒ˜áƒ«áƒšáƒ˜',
        'áƒ¡áƒáƒšáƒ›áƒáƒœáƒ˜', 'áƒ¢áƒ£áƒœáƒ', 'áƒ¡áƒáƒ áƒ“áƒ˜áƒœáƒ˜', 'áƒ™áƒ áƒ”áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜', 'áƒ›áƒ˜áƒ“áƒ˜áƒ”áƒ‘áƒ˜',
        'áƒ˜áƒ¡áƒáƒáƒœáƒáƒ®áƒ˜', 'áƒ‘áƒ áƒáƒ™áƒáƒšáƒ˜', 'áƒáƒ•áƒáƒ™áƒáƒ“áƒ', 'áƒ¡áƒ¢áƒáƒ¤áƒ˜áƒšáƒ', 'áƒ‘áƒáƒœáƒáƒœáƒ˜',
        'áƒ™áƒáƒ áƒáƒ¥áƒ˜', 'áƒ áƒ«áƒ”', 'áƒ˜áƒáƒ’áƒ£áƒ áƒ¢áƒ˜', 'áƒ§áƒ•áƒ”áƒšáƒ˜', 'áƒ™áƒ•áƒ”áƒ áƒªáƒ®áƒ˜',
        'áƒšáƒáƒ‘áƒ˜áƒ', 'áƒœáƒ£áƒ¨áƒ˜', 'áƒ—áƒáƒ•áƒšáƒ˜', 'áƒ™áƒ£áƒœáƒŸáƒ£áƒ—áƒ˜', 'áƒ›áƒ–áƒ”áƒ¡áƒ£áƒ›áƒ–áƒ˜áƒ áƒ˜áƒ¡ áƒ—áƒ”áƒ¡áƒšáƒ˜',
        'áƒ–áƒ¦áƒ•áƒ˜áƒ¡ áƒ™áƒáƒšáƒ›áƒáƒ®áƒ˜', 'áƒ¡áƒáƒ˜áƒ áƒ£áƒšáƒ˜áƒœáƒ', 'áƒ™áƒšáƒáƒ áƒ”áƒšáƒ', 'áƒ áƒ£áƒ®áƒ˜ áƒ‘áƒ áƒ˜áƒœáƒ¯áƒ˜', 'áƒ™áƒ•áƒ˜áƒœáƒáƒ',
        'áƒ¦áƒ˜áƒ áƒ—áƒ”áƒ•áƒ–áƒ˜', 'áƒ›áƒáƒ™áƒ áƒ”áƒšáƒ˜', 'áƒ™áƒáƒ¨áƒ¢áƒœáƒ˜áƒ¡ áƒ¡áƒáƒ™áƒ', 'áƒ¬áƒ˜áƒ—áƒ”áƒšáƒ˜ áƒ®áƒáƒ áƒªáƒ˜', 'áƒ¦áƒáƒ áƒ˜áƒ¡ áƒ®áƒáƒ áƒªáƒ˜'
    ],
    'áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ': [
        'áƒ®áƒáƒ áƒªáƒ˜', 'áƒ¦áƒ•áƒ˜áƒ«áƒšáƒ˜', 'áƒ¦áƒ˜áƒ áƒ®áƒáƒ áƒªáƒ˜', 'áƒ¦áƒ•áƒ˜áƒ«áƒšáƒ˜',
        'áƒ—áƒ”áƒ•áƒ–áƒ˜', 'áƒ—áƒ”áƒ•áƒ–áƒ˜', 'áƒ—áƒ”áƒ•áƒ–áƒ˜', 'áƒ–áƒ¦áƒ•áƒ˜áƒ¡ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜', 'áƒ–áƒ¦áƒ•áƒ˜áƒ¡ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜',
        'áƒ‘áƒáƒ¡áƒ¢áƒœáƒ”áƒ£áƒšáƒ˜', 'áƒ‘áƒáƒ¡áƒ¢áƒœáƒ”áƒ£áƒšáƒ˜', 'áƒ®áƒ˜áƒšáƒ˜', 'áƒ®áƒ˜áƒšáƒ˜', 'áƒ®áƒ˜áƒšáƒ˜',
        'áƒ áƒ«áƒ˜áƒ¡ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜', 'áƒ áƒ«áƒ˜áƒ¡ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜', 'áƒ áƒ«áƒ˜áƒ¡ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜', 'áƒ áƒ«áƒ˜áƒ¡ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜', 'áƒ™áƒ•áƒ”áƒ áƒªáƒ®áƒ˜',
        'áƒ‘áƒ£áƒ áƒ¦áƒ£áƒšáƒ”áƒ£áƒšáƒ˜', 'áƒ™áƒáƒ™áƒáƒšáƒ˜ áƒ“áƒ áƒ—áƒ”áƒ¡áƒšáƒ˜', 'áƒ™áƒáƒ™áƒáƒšáƒ˜ áƒ“áƒ áƒ—áƒ”áƒ¡áƒšáƒ˜', 'áƒ™áƒáƒ™áƒáƒšáƒ˜ áƒ“áƒ áƒ—áƒ”áƒ¡áƒšáƒ˜', 'áƒ™áƒáƒ™áƒáƒšáƒ˜ áƒ“áƒ áƒ—áƒ”áƒ¡áƒšáƒ˜',
        'áƒ–áƒ¦áƒ•áƒ˜áƒ¡ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜', 'áƒ¡áƒ£áƒáƒ”áƒ áƒ¤áƒ£áƒ“áƒ˜', 'áƒ¡áƒ£áƒáƒ”áƒ áƒ¤áƒ£áƒ“áƒ˜', 'áƒ›áƒáƒ áƒªáƒ•áƒšáƒ”áƒ£áƒšáƒ˜', 'áƒ›áƒáƒ áƒªáƒ•áƒšáƒ”áƒ£áƒšáƒ˜',
        'áƒ—áƒ”áƒ•áƒ–áƒ˜', 'áƒ—áƒ”áƒ•áƒ–áƒ˜', 'áƒ¡áƒáƒ™áƒ', 'áƒ®áƒáƒ áƒªáƒ˜', 'áƒ®áƒáƒ áƒªáƒ˜'
    ],
    'áƒ áƒ™áƒ˜áƒœáƒ_áƒ›áƒ’': [
        3.3, 30.5, 2.6, 13.0,
        0.8, 1.3, 2.9, 1.8, 6.7,
        2.7, 0.7, 0.6, 0.1, 0.3,
        0.2, 0.03, 0.1, 0.4, 1.2,
        6.2, 2.9, 3.7, 14.6, 5.2,
        90.0, 28.5, 58.0, 0.8, 4.6,
        1.0, 1.6, 0.5, 2.9, 0.9
    ],
    'B12_áƒ›áƒ™áƒ’': [
        2.6, 83.1, 2.4, 16.6,
        4.9, 4.3, 8.9, 1.1, 24.0,
        0.0, 0.0, 0.0, 0.0, 0.0,
        0.2, 0.4, 0.5, 0.8, 0.6,
        0.0, 0.0, 0.0, 0.0, 0.0,
        1.5, 175.0, 65.0, 0.0, 0.0,
        5.4, 19.0, 0.0, 2.1, 0.7
    ],
    'áƒ¤áƒáƒšáƒáƒ¢áƒ˜_áƒ›áƒ™áƒ’': [
        4, 290, 6, 588,
        26, 5, 10, 3, 76,
        194, 63, 81, 3, 20,
        3, 5, 7, 27, 47,
        394, 28, 57, 79, 227,
        180, 94, 23, 8, 184,
        12, 2, 17, 7, 3
    ],
    'C_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_áƒ›áƒ’': [
        0, 1, 0, 17,
        0, 0, 0, 2, 8,
        28, 89, 10, 4, 9,
        0, 0, 0, 0, 0,
        2, 1, 8, 0, 1,
        3, 10, 9, 0, 0,
        0, 0, 2, 0, 1
    ],
    'D_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_IU': [
        3, 15, 7, 44,
        360, 154, 164, 5, 76,
        0, 0, 0, 0, 0,
        142, 115, 5, 24, 82,
        0, 0, 0, 0, 0,
        0, 0, 0, 0, 0,
        388, 388, 375, 6, 53
    ],
    'áƒ™áƒáƒšáƒªáƒ˜áƒ£áƒ›áƒ˜_áƒ›áƒ’': [
        12, 5, 18, 8,
        12, 4, 382, 70, 26,
        99, 47, 12, 6, 5,
        24, 113, 110, 721, 50,
        113, 37, 160, 975, 78,
        1170, 120, 74, 23, 47,
        20, 12, 3, 7, 5
    ],
    'áƒ›áƒáƒ’áƒœáƒ˜áƒ£áƒ›áƒ˜_áƒ›áƒ’': [
        20, 18, 20, 19,
        29, 64, 39, 39, 34,
        79, 21, 29, 5, 27,
        2, 10, 11, 28, 10,
        140, 158, 168, 351, 325,
        560, 195, 315, 143, 197,
        27, 97, 9, 17, 16
    ]
}

# DataFrame-áƒ˜áƒ¡ áƒ¨áƒ”áƒ¥áƒ›áƒœáƒ
df = pd.DataFrame(products_data)

# áƒ¡áƒ¢áƒ áƒ˜áƒ›áƒšáƒ˜áƒ¢áƒ˜áƒ¡ áƒáƒáƒšáƒ˜áƒ™áƒáƒªáƒ˜áƒ
def main():
    st.set_page_config(page_title="áƒ¡áƒáƒ™áƒ•áƒ”áƒ‘áƒ˜ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœ-áƒ›áƒ˜áƒœáƒ”áƒ áƒáƒšáƒ£áƒ áƒ˜ áƒ«áƒ˜áƒ”áƒ‘áƒ", layout="wide")
    
    st.title("ğŸ¥— áƒ¡áƒáƒ™áƒ•áƒ”áƒ‘áƒ˜ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœ-áƒ›áƒ˜áƒœáƒ”áƒ áƒáƒšáƒ£áƒ áƒ˜ áƒ«áƒ˜áƒ”áƒ‘áƒ")
    st.markdown("---")
    
    # áƒ›áƒ®áƒáƒ áƒ”áƒ¡ áƒáƒáƒœáƒ”áƒšáƒ˜ áƒ¤áƒ˜áƒšáƒ¢áƒ áƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡
    with st.sidebar:
        st.header("ğŸ” áƒ«áƒ˜áƒ”áƒ‘áƒ áƒ“áƒ áƒ¤áƒ˜áƒšáƒ¢áƒ áƒ˜")
        
        # áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ˜áƒ¡ áƒ¤áƒ˜áƒšáƒ¢áƒ áƒ˜
        categories = ['áƒ§áƒ•áƒ”áƒšáƒ'] + sorted(df['áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ'].unique().tolist())
        selected_category = st.selectbox("áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ:", categories)
        
        # áƒ¡áƒáƒ«áƒ˜áƒ”áƒ‘áƒ áƒ•áƒ”áƒšáƒ˜
        search_term = st.text_input("áƒ›áƒáƒ«áƒ”áƒ‘áƒœáƒ” áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜/áƒ›áƒ˜áƒœáƒ”áƒ áƒáƒšáƒ˜:", 
                                   placeholder="áƒ›áƒáƒ’: áƒ áƒ™áƒ˜áƒœáƒ, B12, áƒ¤áƒáƒšáƒáƒ¢áƒ˜")
        
        # áƒ›áƒ˜áƒœáƒ˜áƒ›áƒáƒšáƒ£áƒ áƒ˜ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ˜áƒ¡ áƒ¤áƒ˜áƒšáƒ¢áƒ áƒ˜
        if search_term:
            min_amount = st.number_input(f"áƒ›áƒ˜áƒœáƒ˜áƒ›áƒáƒšáƒ£áƒ áƒ˜ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ:", 
                                       min_value=0.0, value=0.0, step=0.1)
        
        st.markdown("---")
        st.markdown("**áƒ«áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ”áƒ‘áƒ˜:**")
        st.markdown("â€¢ áƒ áƒ™áƒ˜áƒœáƒ")
        st.markdown("â€¢ B12")
        st.markdown("â€¢ áƒ¤áƒáƒšáƒáƒ¢áƒ˜")
        st.markdown("â€¢ C áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜")
        st.markdown("â€¢ áƒ™áƒáƒšáƒªáƒ˜áƒ£áƒ›áƒ˜")
        st.markdown("â€¢ áƒ›áƒáƒ’áƒœáƒ˜áƒ£áƒ›áƒ˜")
    
    # áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒ™áƒáƒœáƒ¢áƒ”áƒœáƒ¢áƒ˜
    filtered_df = df.copy()
    
    # áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ˜áƒ¡ áƒ¤áƒ˜áƒšáƒ¢áƒ áƒ˜
    if selected_category != 'áƒ§áƒ•áƒ”áƒšáƒ':
        filtered_df = filtered_df[filtered_df['áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ'] == selected_category]
    
    # áƒ«áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ
    if search_term:
        search_results = search_by_nutrient(filtered_df, search_term, 
                                          min_amount if 'min_amount' in locals() else 0)
        
        if not search_results.empty:
            st.subheader(f"ğŸ¯ áƒ«áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜: '{search_term}'")
            
            # áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ— áƒ¯áƒ’áƒ£áƒ¤áƒ˜áƒ áƒ”áƒ‘áƒ
            categories_found = search_results['áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ'].unique()
            
            for category in sorted(categories_found):
                with st.expander(f"ğŸ“‚ {category}", expanded=True):
                    category_data = search_results[search_results['áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ'] == category]
                    
                    # áƒ§áƒ•áƒ”áƒšáƒáƒ–áƒ” áƒ›áƒ“áƒ˜áƒ“áƒáƒ áƒ˜ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ©áƒ•áƒ”áƒœáƒ”áƒ‘áƒ
                    nutrient_col = find_nutrient_column(search_term)
                    if nutrient_col:
                        category_data = category_data.sort_values(nutrient_col, ascending=False)
                        
                        for _, row in category_data.iterrows():
                            col1, col2 = st.columns([3, 1])
                            with col1:
                                st.write(f"**{row['áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ˜']}**")
                            with col2:
                                value = row[nutrient_col]
                                unit = get_unit(nutrient_col)
                                if value > 0:
                                    st.write(f"`{value} {unit}`")
                                else:
                                    st.write("`0`")
        else:
            st.warning(f"áƒáƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜ '{search_term}'-áƒ˜áƒ—")
    
    else:
        # áƒ§áƒ•áƒ”áƒšáƒ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ˜áƒ¡ áƒ©áƒ•áƒ”áƒœáƒ”áƒ‘áƒ áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—
        st.subheader("ğŸ“‹ áƒ§áƒ•áƒ”áƒšáƒ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ˜ áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—")
        
        categories_to_show = filtered_df['áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ'].unique()
        
        for category in sorted(categories_to_show):
            with st.expander(f"ğŸ“‚ {category}", expanded=False):
                category_data = filtered_df[filtered_df['áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ'] == category]
                
                for _, row in category_data.iterrows():
                    st.write(f"â€¢ **{row['áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ˜']}**")
    
    # áƒ¡áƒ¢áƒáƒ¢áƒ˜áƒ¡áƒ¢áƒ˜áƒ™áƒ
    st.markdown("---")
    col1, col2, col3 = st.columns(3)
    
    with col1:
        st.metric("áƒ¡áƒ£áƒš áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ˜", len(filtered_df))
    
    with col2:
        st.metric("áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ”áƒ‘áƒ˜", len(filtered_df['áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ'].unique()))
    
    with col3:
        if search_term and 'search_results' in locals():
            st.metric("áƒ«áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜", len(search_results))

def find_nutrient_column(search_term):
    """áƒ•áƒáƒáƒ£áƒšáƒáƒ‘áƒ— áƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡ áƒ¡áƒ•áƒ”áƒ¢áƒ¡ áƒ«áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ¢áƒ”áƒ áƒ›áƒ˜áƒœáƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—"""
    search_lower = search_term.lower()
    
    nutrient_mapping = {
        'áƒ áƒ™áƒ˜áƒœáƒ': 'áƒ áƒ™áƒ˜áƒœáƒ_áƒ›áƒ’',
        'iron': 'áƒ áƒ™áƒ˜áƒœáƒ_áƒ›áƒ’',
        'b12': 'B12_áƒ›áƒ™áƒ’',
        'áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜ b12': 'B12_áƒ›áƒ™áƒ’',
        'áƒ¤áƒáƒšáƒáƒ¢áƒ˜': 'áƒ¤áƒáƒšáƒáƒ¢áƒ˜_áƒ›áƒ™áƒ’',
        'folate': 'áƒ¤áƒáƒšáƒáƒ¢áƒ˜_áƒ›áƒ™áƒ’',
        'c': 'C_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_áƒ›áƒ’',
        'áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜ c': 'C_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_áƒ›áƒ’',
        'vitamin c': 'C_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_áƒ›áƒ’',
        'd': 'D_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_IU',
        'áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜ d': 'D_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_IU',
        'vitamin d': 'D_áƒ•áƒ˜áƒ¢áƒáƒ›áƒ˜áƒœáƒ˜_IU',
        'áƒ™áƒáƒšáƒªáƒ˜áƒ£áƒ›áƒ˜': 'áƒ™áƒáƒšáƒªáƒ˜áƒ£áƒ›áƒ˜_áƒ›áƒ’',
        'calcium': 'áƒ™áƒáƒšáƒªáƒ˜áƒ£áƒ›áƒ˜_áƒ›áƒ’',
        'áƒ›áƒáƒ’áƒœáƒ˜áƒ£áƒ›áƒ˜': 'áƒ›áƒáƒ’áƒœáƒ˜áƒ£áƒ›áƒ˜_áƒ›áƒ’',
        'magnesium': 'áƒ›áƒáƒ’áƒœáƒ˜áƒ£áƒ›áƒ˜_áƒ›áƒ’'
    }
    
    return nutrient_mapping.get(search_lower)

def get_unit(column_name):
    """áƒ•áƒáƒ‘áƒ áƒ£áƒœáƒ”áƒ‘áƒ— áƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡ áƒ–áƒáƒ›áƒ˜áƒ¡ áƒ”áƒ áƒ—áƒ”áƒ£áƒšáƒ¡"""
    if 'áƒ›áƒ’' in column_name:
        return 'áƒ›áƒ’'
    elif 'áƒ›áƒ™áƒ’' in column_name:
        return 'áƒ›áƒ™áƒ’'
    elif 'IU' in column_name:
        return 'IU'
    return ''

def search_by_nutrient(df, search_term, min_amount=0):
    """áƒ•áƒ˜áƒ«áƒ”áƒ‘áƒ— áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ¡ áƒ™áƒáƒœáƒ™áƒ áƒ”áƒ¢áƒ£áƒšáƒ˜ áƒœáƒ£áƒ¢áƒ áƒ˜áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—"""
    nutrient_col = find_nutrient_column(search_term)
    
    if not nutrient_col:
        return pd.DataFrame()
    
    # áƒ•áƒ¤áƒ˜áƒšáƒ¢áƒ áƒáƒ•áƒ— áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ”áƒ‘áƒ¡, áƒ áƒáƒ›áƒšáƒ”áƒ‘áƒ˜áƒª áƒ¨áƒ”áƒ˜áƒªáƒáƒ•áƒ”áƒœ áƒáƒ› áƒœáƒ£áƒ¢áƒ áƒ˜áƒ”áƒœáƒ¢áƒ¡ áƒ›áƒ˜áƒœáƒ˜áƒ›áƒáƒšáƒ£áƒ áƒ˜ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ˜áƒ¡ áƒ–áƒ”áƒ›áƒáƒ—
    results = df[df[nutrient_col] > min_amount].copy()
    
    # áƒ•áƒáƒšáƒáƒ’áƒ”áƒ‘áƒ— áƒ›áƒáƒ¦áƒáƒšáƒ˜ áƒ¨áƒ”áƒ›áƒªáƒ•áƒ”áƒšáƒáƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—
    results = results.sort_values(nutrient_col, ascending=False)
    
    return results

if __name__ == "__main__":
    main()